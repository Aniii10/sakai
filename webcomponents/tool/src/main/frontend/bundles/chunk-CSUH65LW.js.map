{
  "version": 3,
  "sources": ["../node_modules/@sakai-ui/sakai-editor/src/SakaiEditor.js"],
  "sourcesContent": ["import { SakaiElement } from \"@sakai-ui/sakai-element\";\nimport { html } from \"lit\";\nimport { ifDefined } from \"lit/directives/if-defined.js\";\nimport { unsafeHTML } from \"lit/directives/unsafe-html.js\";\n\nexport class SakaiEditor extends SakaiElement {\n\n  static properties = {\n\n    elementId: { attribute: \"element-id\", type: String },\n    content: { type: String },\n    active: { type: Boolean },\n    delay: { type: Boolean },\n    textarea: { type: Boolean },\n    toolbar: { attribute: \"toolbar\", type: String },\n    setFocus: { attribute: \"set-focus\", type: Boolean },\n  };\n\n  constructor() {\n\n    super();\n\n    this.toolbar = \"Full\";\n    this.content = \"\";\n    this.elementId = `editable_${Math.floor((1 + Math.random()) * 0x1000000).toString(16).substring(1)}`;\n  }\n\n  getContent() {\n\n    if (this.textarea) {\n      return this.querySelector(\"textarea\").value;\n    }\n    return this.editor.getData();\n  }\n\n  setContent(text) {\n\n    this.content = text;\n\n    if (this.textarea) {\n      this.querySelector(\"textarea\").value = this.content;\n    } else {\n      this.editor.setData(this.content);\n    }\n  }\n\n  clear() {\n\n    if (this.textarea) {\n      this.querySelector(`#${this.elementId}`).value = \"\";\n    } else {\n      this.editor.setData(\"\");\n    }\n  }\n\n  shouldUpdate() {\n    return (this.content || this.elementId);\n  }\n\n  set active(value) {\n\n    this._active = value;\n    if (!this.textarea) {\n      if (value) {\n        this.attachEditor();\n      } else {\n        this.editor.destroy();\n      }\n    }\n  }\n\n  get active() { return this._active; }\n\n  attachEditor() {\n\n    CKEDITOR.instances[this.elementId]?.destroy();\n\n    if (sakai?.editor?.launch) {\n      const options = {\n        autosave: {\n          delay: 10000000,\n          messageType: \"no\"\n        }\n      };\n      this.toolbar && (options.toolbar = this.toolbar);\n      this.editor = sakai.editor.launch(this.elementId, options);\n    } else {\n      this.editor = CKEDITOR.replace(this.elementId, { toolbar: SakaiEditor.toolbars.get(\"basic\") });\n    }\n\n    this.editor.on(\"change\", e => this._dispatchChangedEvent(e.editor.getData()));\n    this.editor.on(\"instanceReady\", e => {\n\n      // TODO: This is a hack. When loading this component in a bootstrap popover, we end up with a\n      // double render, so two instances of either the textarea or ckeditor\n      const editors = this.querySelectorAll(\".cke\");\n      (editors.length > 1) && editors[0].remove();\n      if (this.setFocus) {\n        e.editor.focus();\n      }\n    });\n  }\n\n  _fireChanged(e) {\n    this._dispatchChangedEvent(e.target.value);\n  }\n\n  _dispatchChangedEvent(content) {\n    this.dispatchEvent(new CustomEvent(\"changed\", { detail: { content }, bubbles: true }));\n  }\n\n  firstUpdated() {\n\n    if (!this.delay && !this.textarea) {\n      this.attachEditor();\n      return;\n    }\n\n    if (this.textarea && this.setFocus) {\n      this.querySelector(\"textarea\").focus();\n    }\n  }\n\n  updated() {\n\n    if (this.textarea) {\n      // TODO: This is a hack. When loading this component in a bootstrap popover, we end up with a\n      // double render, so two instances of either the textarea or ckeditor\n      const areas = this.querySelectorAll(\"textarea\");\n      (areas.length > 1) && areas[0].remove();\n    }\n  }\n\n  render() {\n\n    if (this.textarea) {\n      return html `\n        <textarea style=\"width: 100%\" id=\"${this.elementId}\" @input=${this._fireChanged} aria-label=\"Sakai editor textarea\" tabindex=\"0\">${this.content}</textarea>\n      `;\n    }\n\n    return html `\n      <div id=\"${this.elementId}\" tabindex=\"0\" contenteditable=${ifDefined(this.type === \"inline\" && this.active ? \"true\" : undefined)}>${unsafeHTML(this.content)}</div>\n    `;\n  }\n}\n\nSakaiEditor.toolbars = new Map();\nSakaiEditor.toolbars.set(\"basic\", [ { name: \"document\", items : [ \"Source\", \"-\", \"Bold\", \"Italic\", \"Underline\", \"-\", \"Link\", \"Unlink\", \"-\", \"NumberedList\", \"BulletedList\", \"Blockquote\" ] } ]);\n"],
  "mappings": "+HAKO,IAAMA,EAAN,MAAMC,UAAoBC,CAAa,CAE5C,OAAO,WAAa,CAElB,UAAW,CAAE,UAAW,aAAc,KAAM,MAAO,EACnD,QAAS,CAAE,KAAM,MAAO,EACxB,OAAQ,CAAE,KAAM,OAAQ,EACxB,MAAO,CAAE,KAAM,OAAQ,EACvB,SAAU,CAAE,KAAM,OAAQ,EAC1B,QAAS,CAAE,UAAW,UAAW,KAAM,MAAO,EAC9C,SAAU,CAAE,UAAW,YAAa,KAAM,OAAQ,CACpD,EAEA,aAAc,CAEZ,MAAM,EAEN,KAAK,QAAU,OACf,KAAK,QAAU,GACf,KAAK,UAAY,YAAY,KAAK,OAAO,EAAI,KAAK,OAAO,GAAK,QAAS,EAAE,SAAS,EAAE,EAAE,UAAU,CAAC,CAAC,EACpG,CAEA,YAAa,CAEX,OAAI,KAAK,SACA,KAAK,cAAc,UAAU,EAAE,MAEjC,KAAK,OAAO,QAAQ,CAC7B,CAEA,WAAWC,EAAM,CAEf,KAAK,QAAUA,EAEX,KAAK,SACP,KAAK,cAAc,UAAU,EAAE,MAAQ,KAAK,QAE5C,KAAK,OAAO,QAAQ,KAAK,OAAO,CAEpC,CAEA,OAAQ,CAEF,KAAK,SACP,KAAK,cAAc,IAAI,KAAK,SAAS,EAAE,EAAE,MAAQ,GAEjD,KAAK,OAAO,QAAQ,EAAE,CAE1B,CAEA,cAAe,CACb,OAAQ,KAAK,SAAW,KAAK,SAC/B,CAEA,IAAI,OAAOC,EAAO,CAEhB,KAAK,QAAUA,EACV,KAAK,WACJA,EACF,KAAK,aAAa,EAElB,KAAK,OAAO,QAAQ,EAG1B,CAEA,IAAI,QAAS,CAAE,OAAO,KAAK,OAAS,CAEpC,cAAe,CAIb,GAFA,SAAS,UAAU,KAAK,SAAS,GAAG,QAAQ,EAExC,OAAO,QAAQ,OAAQ,CACzB,IAAMC,EAAU,CACd,SAAU,CACR,MAAO,IACP,YAAa,IACf,CACF,EACA,KAAK,UAAYA,EAAQ,QAAU,KAAK,SACxC,KAAK,OAAS,MAAM,OAAO,OAAO,KAAK,UAAWA,CAAO,CAC3D,MACE,KAAK,OAAS,SAAS,QAAQ,KAAK,UAAW,CAAE,QAASJ,EAAY,SAAS,IAAI,OAAO,CAAE,CAAC,EAG/F,KAAK,OAAO,GAAG,SAAUK,GAAK,KAAK,sBAAsBA,EAAE,OAAO,QAAQ,CAAC,CAAC,EAC5E,KAAK,OAAO,GAAG,gBAAiBA,GAAK,CAInC,IAAMC,EAAU,KAAK,iBAAiB,MAAM,EAC3CA,EAAQ,OAAS,GAAMA,EAAQ,CAAC,EAAE,OAAO,EACtC,KAAK,UACPD,EAAE,OAAO,MAAM,CAEnB,CAAC,CACH,CAEA,aAAaA,EAAG,CACd,KAAK,sBAAsBA,EAAE,OAAO,KAAK,CAC3C,CAEA,sBAAsBE,EAAS,CAC7B,KAAK,cAAc,IAAI,YAAY,UAAW,CAAE,OAAQ,CAAE,QAAAA,CAAQ,EAAG,QAAS,EAAK,CAAC,CAAC,CACvF,CAEA,cAAe,CAEb,GAAI,CAAC,KAAK,OAAS,CAAC,KAAK,SAAU,CACjC,KAAK,aAAa,EAClB,MACF,CAEI,KAAK,UAAY,KAAK,UACxB,KAAK,cAAc,UAAU,EAAE,MAAM,CAEzC,CAEA,SAAU,CAER,GAAI,KAAK,SAAU,CAGjB,IAAMC,EAAQ,KAAK,iBAAiB,UAAU,EAC7CA,EAAM,OAAS,GAAMA,EAAM,CAAC,EAAE,OAAO,CACxC,CACF,CAEA,QAAS,CAEP,OAAI,KAAK,SACAC;AAAA,4CAC+B,KAAK,SAAS,YAAY,KAAK,YAAY,oDAAoD,KAAK,OAAO;AAAA,QAI5IA;AAAA,iBACM,KAAK,SAAS,kCAAkCC,EAAU,KAAK,OAAS,UAAY,KAAK,OAAS,OAAS,MAAS,CAAC,IAAIC,EAAW,KAAK,OAAO,CAAC;AAAA,KAEhK,CACF,EAEAZ,EAAY,SAAW,IAAI,IAC3BA,EAAY,SAAS,IAAI,QAAS,CAAE,CAAE,KAAM,WAAY,MAAQ,CAAE,SAAU,IAAK,OAAQ,SAAU,YAAa,IAAK,OAAQ,SAAU,IAAK,eAAgB,eAAgB,YAAa,CAAE,CAAE,CAAC",
  "names": ["SakaiEditor", "_SakaiEditor", "SakaiElement", "text", "value", "options", "e", "editors", "content", "areas", "ke", "to", "ae"]
}
