{
  "version": 3,
  "sources": ["../node_modules/@sakai-ui/sakai-search/src/SakaiSearch.js", "../node_modules/@sakai-ui/sakai-search/sakai-search.js", "../node_modules/@sakai-ui/sakai-calendar/sakai-calendar.js", "../node_modules/@sakai-ui/sakai-grades/sakai-grades.js", "../node_modules/@sakai-ui/sakai-jump-to-top/sakai-jump-to-top.js", "../bundle-entry-points/body-scripts.js"],
  "sourcesContent": ["import { SakaiElement } from \"@sakai-ui/sakai-element\";\nimport { html } from \"lit\";\nimport { unsafeHTML } from \"lit/directives/unsafe-html.js\";\n\nexport class SakaiSearch extends SakaiElement {\n\n  static properties = {\n\n    siteId: { attribute: \"site-id\", type: String },\n    tool: { type: String },\n\n    _results: { state: true },\n    _i18n: { state: true },\n  };\n\n  constructor() {\n\n    super();\n\n    this.searchTerms = \"\";\n    this.searchMinLengthValue = 3;\n\n    this.iconMapping = {\n      \"announcement\": \"si si-sakai-announcements\",\n      \"assignments\": \"si si-sakai-assignment-grades\",\n      \"chat\": \"si si-sakai-chat\",\n      \"sakai.conversations\": \"si si-sakai-conversations\",\n      \"forums\": \"si si-sakai-forums\",\n      \"lessons\": \"si si-sakai-lessonbuildertool\",\n      \"commons\": \"si si-sakai-commons\",\n      \"content\": \"si si-sakai-resources\",\n      \"wiki\": \"si si-sakai-rwiki\"\n    };\n\n    this.loadTranslations(\"search\").then(t => {\n\n      this._i18n = t;\n      this.toolNameMapping = {\n        \"announcement\": this._i18n.toolname_announcement,\n        \"assignments\": this._i18n.toolname_assignment,\n        \"chat\": this._i18n.toolname_chat,\n        \"sakai.conversations\": this._i18n.toolname_conversations,\n        \"forums\": this._i18n.toolname_forum,\n        \"lessons\": this._i18n.toolname_lesson,\n        \"commons\": this._i18n.toolname_commons,\n        \"content\": this._i18n.toolname_resources,\n        \"wiki\": this._i18n.toolname_wiki\n      };\n    });\n  }\n\n  handleKeydownOnResult(e) {\n\n    if (e.code === \"Escape\") {\n      e.preventDefault();\n      this.closeResults();\n    }\n  }\n\n  closeResults() {\n\n    this._results = [];\n    this.dispatchEvent(new CustomEvent(\"hiding-search-results\"));\n    this.querySelector(\"input\").focus();\n  }\n\n  shouldUpdate() {\n    return this._i18n;\n  }\n\n  search(e) {\n\n    e.preventDefault();\n\n    const terms = document.getElementById(\"sakai-search-input\")?.value;\n\n    this.closeResults();\n\n    if (terms.length > this.searchMinLengthValue - 1) {\n\n      const url = `/api/search?terms=${terms}${this.siteId ? `&site=${this.siteId}` : \"\"}${this.tool ? `&tool=${this.tool}` : \"\"}`;\n      fetch(url, {\n        cache: \"no-cache\",\n        credentials: \"same-origin\"\n      })\n      .then(r => {\n\n        if (r.ok) {\n          return r.json();\n        }\n\n        throw new Error(`Failed to get search results from ${url}.`);\n      })\n      .then(data => {\n\n        this.dispatchEvent(new CustomEvent(\"showing-search-results\"));\n        this._results = data;\n\n        this.noResults = this._results.length === 0;\n        this._results.forEach(r => { if (r.title.length === 0) r.title = r.tool; });\n        this.updateComplete.then(() => {\n\n          if (!this.noResults) {\n            const resultItem = this.querySelector(\".search-result-link\");\n            resultItem.focus();\n          }\n          document.querySelectorAll(\".search-result-link\").forEach(el => {\n\n            el.addEventListener(\"keydown\", ke => {\n              ke.stopPropagation();\n\n              switch (ke.code) {\n                case \"ArrowDown\":\n                  if (el.nextElementSibling.classList.contains(\"search-result-link\")) {\n                    el.nextElementSibling.focus();\n                    ke.preventDefault();\n                  }\n\n                  break;\n\n                case \"ArrowUp\":\n                  if (el.previousElementSibling.classList.contains(\"search-result-link\")) {\n                    el.previousElementSibling.focus();\n                    ke.preventDefault();\n                  }\n\n                  break;\n\n                default:\n              }\n            });\n          });\n        });\n\n        this.requestUpdate();\n      })\n      .catch (error => console.error(error));\n    }\n  }\n\n  render() {\n\n    return html`\n      <form class=\"input-group position-relative\" @submit=${this.search}>\n        <input type=\"search\"\n          class=\"sakaiSearch form-control\"\n          autocomplete=\"off\"\n          id=\"sakai-search-input\"\n          pattern=\".{${this.searchMinLengthValue},}\"\n          title=\"${this._i18n.search_min_length.replace(\"{}\", this.searchMinLengthValue)}\"\n          placeholder=\"${this._i18n.search_placeholder}\"\n          value=${this.searchTerms}\n          aria-label=\"${this._i18n.search_placeholder}\"\n        />\n        <button class=\"btn btn-primary\" type=\"submit\" id=\"sakai-search-button\">\n          Search Sakai\n        </button>\n      </form>\n      ${this.noResults ? html`\n        <div class=\"list-group-item d-flex justify-content-between align-items-start\">\n           <span class=\"no-results\">No results found :(</span>\n        </div>\n      ` : \"\"}\n      ${this._results && this._results.length > 0 ? html`\n        <div class=\"d-flex justify-content-end\">\n          <button type=\"button\"\n              class=\"btn icon-button mt-2 mb-1 fs-3 p-0\"\n              title=\"${this._i18n.close_results_tooltip}\"\n              aria-label=\"${this._i18n.close_results_tooltip}\"\n              @click=${this.closeResults}>\n            <i class=\"si si-close\"></i>\n          </button>\n        </div>\n        <div>\n          ${this._results && this._results.map(r => html`\n            <a class=\"search-result-link\" href=\"${r.url}\" @click=${this.toggleField} @keydown=${this.handleKeydownOnResult}>\n              <div class=\"card mb-2\">\n                <div class=\"card-body\">\n                  <div class=\"card-text\">\n                    <div class=\"mb-2\">\n                      <i class=\"search-result-tool-icon ${this.iconMapping[r.tool]}\" title=\"${this.toolNameMapping[r.tool]}\"></i>\n                      <span class=\"search-result-toolname\">${this.toolNameMapping[r.tool]}</span>\n                      <span>${this._i18n.from_site}</span>\n                      <span class=\"search-result-site-title\">${r.siteTitle}</span>\n                    </div>\n                    <div>\n                      <span class=\"search-result-title-label\">${this._i18n.search_result_title}</span>\n                      <span class=\"search-result-title\">${r.title}</span>\n                    </div>\n                    <div class=\"search-result\">${unsafeHTML(r.searchResult)}</div>\n                  </div>\n                </div>\n              </div>\n            </a>\n          `)}\n        </div>\n      ` : \"\"}\n    `;\n  }\n}\n", "import { SakaiSearch } from \"./src/SakaiSearch.js\";\n\ncustomElements.define(\"sakai-search\", SakaiSearch);\n", "import { SakaiCalendar } from './src/SakaiCalendar.js';\n\ncustomElements.define('sakai-calendar', SakaiCalendar);\n", "import { SakaiGrades } from \"./src/SakaiGrades.js\";\n\ncustomElements.define(\"sakai-grades\", SakaiGrades);\n", "import { loadProperties } from \"@sakai-ui/sakai-i18n\";\n\n// load i18n properties and initialize the component when ready\nasync function init() {\n\n  const i18n = await loadProperties(\"jumptotop\");\n  let jumptotopLabel = i18n.jumptotop_title;\n\n  // DOM Elements\n  const portalMainContainer = document.querySelector(\".portal-main-container\");\n  const jumpToTopButton = document.createElement(\"button\");\n  jumpToTopButton.title = jumptotopLabel;\n  jumpToTopButton.ariaLabel = jumptotopLabel;\n  jumpToTopButton.classList.add(\"jump-to-top\");\n  jumpToTopButton.insertAdjacentHTML(\"beforeend\", \"<i class=\\\"si si-arrow-up-circle-fill\\\"></i>\");\n  jumpToTopButton.addEventListener(\"click\", function () {\n    portalMainContainer.scrollTo({ top: 0, behavior: \"smooth\" });\n  });\n  portalMainContainer.appendChild(jumpToTopButton);\n  portalMainContainer.addEventListener(\"scroll\", function () {\n\n    if (portalMainContainer.scrollTop > 500) {\n      jumpToTopButton.classList.add(\"show\");\n    } else {\n      jumpToTopButton.classList.remove(\"show\");\n    }\n  });\n}\n\nexport { init };\n", "import \"@sakai-ui/sakai-permissions/sakai-permissions.js\";\nimport \"@sakai-ui/sakai-search/sakai-search.js\";\nimport \"@sakai-ui/sakai-calendar/sakai-calendar.js\";\nimport \"@sakai-ui/sakai-grades/sakai-grades.js\";\nimport \"get-browser-fingerprint\";\nimport { init as initJumpToTop } from \"@sakai-ui/sakai-jump-to-top/sakai-jump-to-top.js\";\ninitJumpToTop();\n"],
  "mappings": "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",
  "names": ["SakaiSearch", "SakaiElement", "t", "e", "terms", "url", "r", "data", "el", "ke", "error", "ae", "SakaiSearch", "SakaiCalendar", "SakaiGrades", "init", "jumptotopLabel", "loadProperties", "portalMainContainer", "jumpToTopButton", "init"]
}
