{
  "version": 3,
  "sources": ["../node_modules/@sakai-ui/sakai-conversations/src/ConversationsStatistics.js", "../node_modules/@sakai-ui/sakai-conversations/conversations-statistics.js"],
  "sourcesContent": ["import { html } from \"lit\";\nimport { SakaiElement } from \"@sakai-ui/sakai-element\";\nimport \"@sakai-ui/sakai-icon\";\nimport \"@sakai-ui/sakai-pager\";\nimport { SORT_NAME, SORT_TOPICS_CREATED, SORT_TOPICS_VIEWED, SORT_POSTS_CREATED, SORT_REACTIONS_MADE, ALL_TIME, THIS_WEEK } from \"./sakai-conversations-constants.js\";\n\nexport class ConversationsStatistics extends SakaiElement {\n\n  static properties = {\n\n    statsUrl: { attribute: \"stats-url\", type: String },\n    _stats: { state: true },\n  };\n\n  constructor() {\n\n    super();\n\n    this._sort = \"nameAscending\";\n    this._sortByNameAscending = true;\n    this._count = 0;\n\n    this.loadTranslations(\"conversations\").then(r => this.i18n = r);\n  }\n\n  set statsUrl(value) {\n\n    const oldValue = this._statsUrl;\n    this._statsUrl = value;\n\n    this._loadStatsPage(1);\n\n    this.requestUpdate(\"statsUrl\", oldValue);\n  }\n\n  get statsUrl() { return this._statsUrl; }\n\n  _loadStatsPage(page) {\n\n    if (!this._statsUrl) return;\n\n    const options = {\n      page,\n      sort: this._sort,\n      interval: typeof(this.interval) === \"undefined\" ? THIS_WEEK : this.interval,\n    };\n\n    fetch(`${this._statsUrl}`, {\n      method: \"POST\",\n      credentials: \"include\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(options),\n    })\n    .then(r => {\n\n      if (r.ok) {\n        return r.json();\n      }\n      throw new Error(`Network error while getting statistics from ${this.siteUrl}`);\n    })\n    .then(data => {\n\n      this._count = Math.ceil(data.total / data.pageSize);\n      this._stats = data.stats;\n      this._currentPage = data.currentPage;\n    })\n    .catch(error => console.error(error));\n  }\n\n  set interval(value) {\n\n    this._interval = value;\n    this._loadStatsPage(1);\n  }\n\n  get interval() { return this._interval; }\n\n  set sort(value) {\n\n    this._sort = value;\n    this._loadStatsPage(1);\n  }\n\n  get sort() { return this._sort; }\n\n  _pageClicked(e) {\n\n    this._loadStatsPage(e.detail.page);\n    this.requestUpdate();\n  }\n\n  _toggleSort(e) {\n\n    switch (e.target.dataset.sort) {\n      case SORT_NAME:\n        this._sortByNameAscending = !this._sortByNameAscending;\n        this._sort = this._sortByNameAscending ? \"nameAscending\" : \"nameDescending\";\n        break;\n      case SORT_TOPICS_CREATED:\n        this._sortByTopicsCreatedAscending = !this._sortByTopicsCreatedAscending;\n        this._sort = this._sortByTopicsCreatedAscending ? \"topicsCreatedAscending\" : \"topicsCreatedDescending\";\n        break;\n      case SORT_TOPICS_VIEWED:\n        this._sortByTopicsViewedAscending = !this._sortByTopicsViewedAscending;\n        this._sort = this._sortByTopicsViewedAscending ? \"topicsViewedAscending\" : \"topicsViewedDescending\";\n        break;\n      case SORT_REACTIONS_MADE:\n        this._sortByReactionsMadeAscending = !this._sortByReactionsMadeAscending;\n        this._sort = this._sortByReactionsMadeAscending ? \"reactionsMadeAscending\" : \"reactionsMadeDescending\";\n        break;\n      case SORT_POSTS_CREATED:\n        this._sortByPostsCreatedAscending = !this._sortByPostsCreatedAscending;\n        this._sort = this._sortByPostsCreatedAscending ? \"postsCreatedAscending\" : \"postsCreatedDescending\";\n        break;\n      default:\n    }\n\n    this._loadStatsPage(1);\n  }\n\n  _setThisWeek() { this.interval = THIS_WEEK; }\n\n  _setAllTime() { this.interval = ALL_TIME; }\n\n  shouldUpdate() {\n    return this.i18n && this._stats;\n  }\n\n  render() {\n\n    return html`\n      <div class=\"add-topic-wrapper\">\n        <h1>${this.i18n.statistics}</h1>\n        <div id=\"statistics-timeframe-block\">\n          <div>${this.i18n.timeframe}</div>\n          <input type=\"radio\"\n              name=\"timeframe\"\n              value=\"${THIS_WEEK}\"\n              @click=\"${this._setThisWeek}\"\n              checked>${this.i18n.this_week}\n          <input type=\"radio\"\n              name=\"timeframe\"\n              value=\"${ALL_TIME}\"\n              @click=\"${this._setAllTime}\">${this.i18n.all_time}\n        </div>\n      </div>\n        <sakai-pager count=\"${this._count}\" current=\"${this._currentPage}\" @page-selected=${this._pageClicked}></sakai-pager>\n        <table id=\"statistics-report-table\" class=\"table table-hover table-striped table-bordered\">\n          <thead>\n            <tr>\n              <th>\n                <a href=\"javascript:;\"\n                    data-sort=\"${SORT_NAME}\"\n                    title=\"${this.i18n.sort_by_author}\"\n                    aria-label=\"${this.i18n.sort_by_author}\"\n                    @click=${this._toggleSort}>\n                  <div class=\"header-sort-block\">\n                    <div>${this.i18n.name_header}</div>\n                    <div>\n                      <sakai-icon type=\"${this._sortByNameAscending ? \"down\" : \"up\"}\" size=\"small\"></sakai-icon>\n                    </div>\n                  </div>\n                </a>\n              </th>\n              <th>\n                <a href=\"javascript:;\"\n                    data-sort=\"${SORT_TOPICS_CREATED}\"\n                    title=\"${this.i18n.sort_by_created_topics}\"\n                    aria-label=\"${this.i18n.sort_by_created_topics}\"\n                    @click=${this._toggleSort}>\n                  <div class=\"header-sort-block\">\n                    <div>${this.i18n.topics_created_header}</div>\n                    <div>\n                      <sakai-icon type=\"${this._sortByTopicsCreatedAscending ? \"down\" : \"up\"}\" size=\"small\"></sakai-icon>\n                    </div>\n                  </div>\n                </a>\n              </th>\n              <th>\n                <a href=\"javascript:;\"\n                    data-sort=\"${SORT_TOPICS_VIEWED}\"\n                    title=\"${this.i18n.sort_by_viewed_topics}\"\n                    aria-label=\"${this.i18n.sort_by_viewed_topics}\"\n                    @click=${this._toggleSort}>\n                  <div class=\"header-sort-block\">\n                    <div>${this.i18n.topics_read_header}</div>\n                    <div>\n                      <sakai-icon type=\"${this._sortByTopicsViewedAscending ? \"down\" : \"up\"}\" size=\"small\"></sakai-icon>\n                    </div>\n                  </div>\n                </a>\n              </th>\n              <th>\n                <a href=\"javascript:;\"\n                    data-sort=\"${SORT_REACTIONS_MADE}\"\n                    title=\"${this.i18n.sort_by_reactions_made}\"\n                    aria-label=\"${this.i18n.sort_by_reactions_made}\"\n                    @click=${this._toggleSort}>\n                  <div class=\"header-sort-block\">\n                    <div>${this.i18n.reactions_header}</div>\n                    <div>\n                      <sakai-icon type=\"${this._sortByReactionsMadeAscending ? \"down\" : \"up\"}\" size=\"small\"></sakai-icon>\n                    </div>\n                  </div>\n                </a>\n              </th>\n              <th>\n                <a href=\"javascript:;\"\n                    data-sort=\"${SORT_POSTS_CREATED}\"\n                    title=\"${this.i18n.sort_by_created_posts}\"\n                    aria-label=\"${this.i18n.sort_by_created_posts}\"\n                    @click=${this._toggleSort}>\n                  <div class=\"header-sort-block\">\n                    <div>${this.i18n.posts_header}</div>\n                    <div>\n                      <sakai-icon type=\"${this._sortByPostsCreatedAscending ? \"down\" : \"up\"}\" size=\"small\"></sakai-icon>\n                    </div>\n                  </div>\n                </a>\n              </th>\n            </tr>\n          </thead>\n          <tbody>\n        ${this._stats.map(stat => html`\n          <tr>\n            <td>${stat.name}</td>\n            <td>${stat.topicsCreated}</td>\n            <td>${stat.topicsViewed}</td>\n            <td>${stat.reactionsMade}</td>\n            <td>${stat.postsCreated}</td>\n          </tr>\n        `)}\n          </tbody>\n        </table>\n      </div>\n    `;\n  }\n}\n", "import { ConversationsStatistics } from './src/ConversationsStatistics.js';\n\ncustomElements.define('conversations-statistics', ConversationsStatistics);\n"],
  "mappings": "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",
  "names": ["ConversationsStatistics", "SakaiElement", "r", "value", "oldValue", "page", "options", "THIS_WEEK", "data", "error", "e", "SORT_NAME", "SORT_TOPICS_CREATED", "SORT_TOPICS_VIEWED", "SORT_REACTIONS_MADE", "SORT_POSTS_CREATED", "ALL_TIME", "ke", "stat", "ConversationsStatistics"]
}
